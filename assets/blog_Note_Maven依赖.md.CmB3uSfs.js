import{_ as i,o as a,c as t,a6 as n}from"./chunks/framework.BkI9ovSD.js";const l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAc0AAABUCAYAAADgW2wiAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAB90RVh0U29mdHdhcmUATWFjcm9tZWRpYSBGaXJld29ya3MgOLVo0ngAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDMvMDUvMjFd2l/bAAAO1ElEQVR4nO3de2xUdZ/H8fcZ2lLbpTRFBIRYUAzWgOASFRAQ5ZIgZFlK5BYDWgM/DQlq4rJ/rGRxnxhjjNBdRPk92S3QjeIGL+16gV0Kzy6KYFyiWGMCAgWhQENBKFvoUjtn/5i2T7l22k7nXObz+ms4cyZ8pvPJfGfOnIvjui5hY4wJ35MSEQkIa63jdYbuEvE6gIiISFBoaIqIiMQpzesA3S3MmwlERPwiVX4W0zdNERGROGloioiIxElDU0REJE4amiIiInHS0BQREYmThqaIiEicNDRFRETipKEpIiISJw1NERGROGloioiIxElDU0REJE4amiIiInHS0BQREYmThqaIiEicNDRFRETipKEpIiISJw1NERGROGloioiIxElDU0REJE4amiIiInHS0BQREYmThqaIiEicNDRFRETilOZ1ABERCRZjzEhgNlBsrT1/k3VygZeAP1lr/zuZ+bqTvmmKiEiHWGv3A4uBKmPMM9fe37ysClgcpoEJGpoiItI5q4BcYIMxpuqa+zY037cqyZm6nYamiIh0RhnQsml28A3uP9+8TqhoaIqISIdZay8AG2+xysbmdUJFQ1NERDqruJP3BZaGpoiIdIq19hg33gRb1nxf6GhoiohIV2yMc1koaGiKiEinWWvLgaNtFh1tXhZKGpoiItJVxTe5HTqO67pxr2yMmQw8B4wG7gRuw5+D12lzO/4n2L3+DzgF7AU2WWv/w+M8KStAPfYj9dgnfNjjlvddv7zn3kqne9zu0DTG5AOvAE8DOYDjOI5zywd5rO1z8ltU98/hzgHvAO9Za2s8jJQSgthjP1OPveHnHrdUwidx4tKZHt90aBpjsom9MK86jjOQ2IvDgAEDGDJkCAUFBQwePJisrKxA/ZG80NDQwOHDhzlw4ACHDx/m1KlTrS+W67rVwKvAZmvtFW+Tho96nDjqsXeC0ONz584BkJeX58n/H6+u9viGQ9MY0w/4J6DQcZwe2dnZzrhx45g0aRJZWVnd+HRSQ319PTt27GDPnj00NDS4rus2AZ8Ay/VpPXHU4+6lHieHety9Otrj64Zm89f//wTuTU9PZ/jw4c6TTz5J3759k/IEUklNTQ1lZWUcPHiQpqamKPADMM1ae9brbEGnHiePetx91OPkibfHVw1NY8wQYAvwl5FIxJk9ezYTJkxIavBU9NVXX/Hpp58SjUZd4E/AM9ba417nCir12BvqcWKpx95or8fX7mm1BngwKyuLRYsWMX78+GRmTVmPPvoos2bNIiMjA8dxJgF/8DpTwKnHHlCPE0499kB7PW4dmsaYIuDJSCQSmTlzpjNq1CjtGJEkkUiExx57jKlTpzqO40Qcx5lrjPlrr3MFkXrsHfU4cdRj77TX4wiAMaYX8J7jOOkjR47kkUce8SxwKps4cSL33nsvxI63es/jOIGjHvuDetw16rE/3KzHLd80/wbIcByHwsJCevTo4UFE6dmzJ3PnziUSiQD0M8a85nWmgFGPfUA97jL12Adu1uNI8/E/xnEc94knnqBXr16eBk11ffr0YcyYMTQfsLzMGJPhdaYgUI/9RT3uHPXYX27U4wgwHejTs2dPZ+LEiR5HFICpU6e2fLrJJXaKLGmfeuwz6nGnqMc+c22PI8Bsx3Eiffv2JScnx9t0AkBubi55eXk4jhMB5nudJyDUY59RjztFPfaZa3scAUYB3H333d4mk6vk5+e33NTHzfioxz6kHneYeuxDbXscAQYCjl4kfxk6dCjErhpwp8dRgkI99iH1uMPUYx9q2+MIzXtpDRw40NtUXVBbW0ttba3XMRJq0KBBLTe1jSY+ge9xGKnHHaYe+1DbHqcBGUBgt58fOHCABx98EIB9+/ZRUFDgcaLEaHNuSe11GJ/A9bixsZELFy5ctzwvL69lx4PAU487LHA9htiVQ6qqqqipiZ3fPC8vj3vuuYfs7GyPkyVG2x6n0Xz+2YyMYHa6vLycnJwc6urq+Oyzz0IzNHv27Ol1hKAJXI8PHTrE6NHX71Sak5ODMYYXX3zR95dZao963GGB6nFtbS0lJSWsXr2aurq66+4vLy9n6tSpHiRLrLY9TgPcoJ6eqaGhgXXr1jFt2jSqq6tZvXo1y5YtC82nG+mQwPb4vvvuY/782M6l9fX1fPzxx7z11lts27aNnTt3qs+pJTA9PnDgADNnzqS6uprRo0fz7LPPtu7AdOTIEcrKyjh7NnwXuknzOkBX7N27lzNnzjBv3jxqa2t54YUX+Oabb0LxyUbAGDPJWvtfXufobg8//DArVqxo/feKFStYsGABFRUV6nMIhLHHx44dY9q0aZw5c4ZNmzYxZ86cq35SmDRpEkVFRdTX13uYsnsEemh++OGHZGZmMn78eC5evAhASUmJ3mTC4zFjzAbgNaDMWnve60DJkJ2dzdy5c6moqAjlJ/UUFLoer1y5snVgPvXUUzddL4xbSQK7t0FNTQ2lpaUsXLiQ3r17M2jQIKZPn055eTnHjh3zOp4kRjGxs3BsAKqMMcXGmMHeRkqOM2fOADBs2DCPk0gChKrHhw4d4qOPPmLs2LHMmTPH6zhJF9ihuX37dgDmzZvXuqyoqAiAL774wpNMkljW2gvAS83/zAVeJPamUxbmS079+OOPvPnmm8yaNYuRI0d6HUe6KGw93rt3LwBLliwJzV7eHRHIzbPRaJS1a9eSk5PDQw891Lp8/PjxZGZmsmbNGpYsWUJ6erqHKSURrLWbjDGrgMFtFs8CZhljjgL/CGxMdq5E2rFjB88//zwAv/zyC3v27GHVqlUsW7YsJd+UwihMPf7555+B1gP+U04gh+ZPP/1EZWUlr776KpmZma3Le/fuzcKFCykpKeG7775j3LhxHqZMHGPMRSB8Pw7Er+EmywcTu7r93xPgrSbV1dWUlpZetWz16tXk5uayaNGiqzoeZOpxOHp87tw5IJy/V8YjkEOzvLwcgA0bNrB169ar7jt9+jQAH3zwQWiGpoTbokWLWL9+PRA74cGRI0dYs2YNL730EjU1NaxcudLjhCJ/lpYWGxsNDTf7DBBugRuaFy9eZN26dWRmZtK/f//r7u/fvz8XL16kpKSEVatWcfvtt3uQMrGstSl9UT1jTBVXb9ZqcZTYThYbgbNA4K/Wm56ezrBhwyguLmbHjh288cYbLF++nN69e3sdrcvU43D0uGXntKqqqtazsaWSwA3N3bt3U1dXx+uvv87LL798w3XeffddXnnlFbZt28bTTz+d5ISSSMaYxVz/RlMGbLTWlrdZL5mxul1mZiaTJ0+mtLSUkydPhmJoprIw9XjUqFEAvP/++xQWFnqcJvl8v/38Wps2bQK45bGYM2bMAGDt2rVEo9Gk5JLEM8bkEvsEDnC++fZga+3stm80YRSNRvn+++8B6NUrpb+gBV7YejxmzBgGDhzI1q1bW49iSCWBGponTpygvLycESNGcP/99990vfz8fKZPn05lZSX79+9PYsLE0bAHYrvmnweeIfYm87K1NvQH4TY2NrJ+/XoqKyuZMmVK2yssBI56DISsx+np6ZSUlACxQ/62bdt2w9e5vr4+NMfMt31+rZtnm5qa6NHD15vS+fLLLwF47rnn2t0Vv6ioiK1bt1JWVhbI7e5tTj/V5GUOj5VZa1/ryAOC0ONrtT3kpLGxkV27dlFdXc3AgQMpLi5u59H+ph4DIezxhAkTKCkpoaioiMLCQkaPHk1hYSEDBgzg0qVLVFZWsnnzZoqLi9tewDmw2vY4Dfgd6HH+/Hn69OnjXao4LF26lKVLl8a17owZM7h06VI3J+o+v/32W8vNRi9zeMla25HNBIHp8bWuPeRkxIgRLF++nAULFgR+Rzb1OLw9nj9/PsOHD+edd96htLSUffv2td6XmZnJ4sWLGTt2rIcJE6dtj9OA/wUyfv31V8fvL1IqOXnyZMvN66+3IzcSuB4XFBQE+oNdPNTjDgtUj4cPH8769et5++23OXXqFI2NjWRlZdGvX7/QHF8MV/c4AlRD7FIu4h8HDx4EcIntji7tU499SD3usED2ODs7m6FDh1JQUEB+fn6oBiZc3eMIsN91Xff48ePeppKrVFdXt9zc7WWOAFGPfUg97jD12Ifa9jgCbHFdN3r69GkuXLjgYSxpcfbsWWpra3FdNwp86HWegFCPfUY97hT12Geu7XEE2AWcuXLlirt7tz4M+kFFRQXRaNQFfrXW/o/XeQJCPfYZ9bhT1GOfubbHkebL1vxrNBp1v/7669br+Ik3jh492nJsqQv8i8dxAkM99hf1uHPUY3+5UY9bDnZ8B6i+fPkymzdv5sqVKx5FlE8++YTLly+7ruvuB/7Z6zwBox77hHrcJeqxT9yoxxEAa+1x4G9d122qqqpKyVMjea2pqYnPP/+c48eP47puE/AP1toar3MFiXrsPfW469Rj792qx21Pq7MF+DfXdd1du3a5P/zwgydhU9WePXvYuXNny4/NpcCXXmcKKPXYQ+pxwqjHHrpVjx3XdVtXNMb0Acocx3k0LS2NKVOmOI8//jgZGRnJT50i6uvr2b59O7t373Z///13XNfdYa29+dnopV3qcfKpx4mnHidfPD2+amgCGGPuA0qARxzHieTn5zN37lzuvPPOJEZPDSdOnGDLli0cP36caOyMwF8DC6y1J9t7rNyaepw86nH3UY+TJ94eXzc0AYwxWcR+jF7kOE6P2267jQceeIDJkyfTt2/fpDyBMDt79iwVFRV8++23RKNRHMe55Lrue8AfmveekwRQj7uXepwc6nH36miPbzg0AYwxacDTwN85jnO34zhOjx49nNzcXO666y4GDx7MkCFDuOOOO7S54BauXLnCuXPnOHLkCIcPH+bYsWPU1dXR2NjourE//mlgkbV2h9dZw0g9Tgz12FvqcWIkosc3HZotjDH9gCXEXrB7HMeJOI7jtDw+Qc8lFbgAruu27I11EvgjUGytrb/lI6XL1OOEUY89pB4nTKd73O7QbGGMyQRGAn8FPA7cBfwFkI1erPZcIXaVh6PATuDfgR+stQ1ehkpF6nGXqMc+oR53SZd6/P9n0MJWdt9tHwAAAABJRU5ErkJggg==",p="/assets/573.D0-y2F9d.png",y=JSON.parse('{"title":"Maven依赖","description":"","frontmatter":{"title":"Maven依赖","date":"2023-04-19T00:00:00.000Z","tags":["Maven"],"categories":["笔记"]},"headers":[],"relativePath":"blog/Note/Maven依赖.md","filePath":"blog/Note/Maven依赖.md","lastUpdated":1734485485000}'),h={name:"blog/Note/Maven依赖.md"};function e(k,s,E,d,r,g){return a(),t("div",{"data-pagefind-body":!0},s[0]||(s[0]=[n('<h1 id="maven依赖" tabindex="-1">Maven依赖 <a class="header-anchor" href="#maven依赖" aria-label="Permalink to &quot;Maven依赖&quot;">​</a></h1><p>Maven 依赖传递是 Maven 的核心机制之一，它能够一定程度上简化 Maven 的依赖配置。本节我们将详细介绍依赖传递及其相关概念。</p><h2 id="依赖传递" tabindex="-1">依赖传递 <a class="header-anchor" href="#依赖传递" aria-label="Permalink to &quot;依赖传递&quot;">​</a></h2><p>如下图所示，项目 A 依赖于项目 B，B 又依赖于项目 C，此时 B 是 A 的直接依赖，C 是 A 的间接依赖。</p><p><img src="'+l+`" alt="依赖传递"></p><p>Maven 的依赖传递机制是指：不管 Maven 项目存在多少间接依赖，POM 中都只需要定义其直接依赖，不必定义任何间接依赖，Maven 会动读取当前项目各个直接依赖的 POM，将那些必要的间接依赖以传递性依赖的形式引入到当前项目中。Maven 的依赖传递机制能够帮助用户一定程度上简化 POM 的配置。</p><p>基于 A、B、C 三者的依赖关系，根据 Maven 的依赖传递机制，我们只需要在项目 A 的 POM 中定义其直接依赖 B，在项目 B 的 POM 中定义其直接依赖 C，Maven 会解析 A 的直接依赖 B的 POM ，将间接依赖 C 以传递性依赖的形式引入到项目 A 中。</p><p>通过这种依赖传递关系，可以使依赖关系树迅速增长到一个很大的量级，很有可能会出现依赖重复，依赖冲突等情况，Maven 针对这些情况提供了如下功能进行处理。</p><ul><li>依赖范围（Dependency scope）</li><li>依赖调解（Dependency mediation）</li><li>可选依赖（Optional dependencies）</li><li>排除依赖（Excluded dependencies）</li><li>依赖管理（Dependency management）</li></ul><h2 id="依赖范围" tabindex="-1">依赖范围 <a class="header-anchor" href="#依赖范围" aria-label="Permalink to &quot;依赖范围&quot;">​</a></h2><p>首先，我们要知道 Maven 在对项目进行编译、测试和运行时，会分别使用三套不同的 classpath。Maven 项目构建时，在不同阶段引入到 classpath 中的依赖时不同的。例如编译时，Maven 会将与编译相关的依赖引入到编译 classpath 中；测试时，Maven 会将与测试相关的的依赖引入到测试 classpath 中；运行时，Maven 会将与运行相关的依赖引入到运行 classpath 中。</p><p>我们可以在 POM 的依赖声明使用 scope 元素来控制依赖与三种 classpath（编译 classpath、测试 classpath、运行 classpath ）之间的关系，这就是依赖范围。</p><p>Maven 具有以下 6 中常见的依赖范围，如下表所示。</p><table tabindex="0"><thead><tr><th>依赖范围</th><th>描述</th></tr></thead><tbody><tr><td>compile</td><td>编译依赖范围，scope 元素的缺省值。使用此依赖范围的 Maven 依赖，对于三种 classpath 均有效，即该 Maven 依赖在上述三种 classpath 均会被引入。例如，log4j 在编译、测试、运行过程都是必须的。</td></tr><tr><td>test</td><td>测试依赖范围。使用此依赖范围的 Maven 依赖，只对测试 classpath 有效。例如，Junit 依赖只有在测试阶段才需要。</td></tr><tr><td>provided</td><td>已提供依赖范围。使用此依赖范围的 Maven 依赖，只对编译 classpath 和测试 classpath 有效。例如，servlet-api 依赖对于编译、测试阶段而言是需要的，但是运行阶段，由于外部容器已经提供，故不需要 Maven 重复引入该依赖。</td></tr><tr><td>runtime</td><td>运行时依赖范围。使用此依赖范围的 Maven 依赖，只对测试 classpath、运行 classpath 有效。例如，JDBC 驱动实现依赖，其在编译时只需 JDK 提供的 JDBC 接口即可，只有测试、运行阶段才需要实现了 JDBC 接口的驱动。</td></tr><tr><td>system</td><td>系统依赖范围，其效果与 provided 的依赖范围一致。其用于添加非 Maven 仓库的本地依赖，通过依赖元素 dependency 中的 systemPath 元素指定本地依赖的路径。鉴于使用其会导致项目的可移植性降低，一般不推荐使用。</td></tr><tr><td>import</td><td>导入依赖范围，该依赖范围只能与 dependencyManagement 元素配合使用，其功能是将目标 pom.xml 文件中 dependencyManagement 的配置导入合并到当前 pom.xml 的 dependencyManagement 中。</td></tr></tbody></table><p>依赖范围与三种 classpath 的关系一览表，如下所示。</p><table tabindex="0"><thead><tr><th>依赖范围</th><th>编译 classpath</th><th>测试 classpath</th><th>运行 classpath</th><th>例子</th></tr></thead><tbody><tr><td>compile</td><td>√</td><td>√</td><td>√</td><td>log4j</td></tr><tr><td>test</td><td>-</td><td>√</td><td>-</td><td>junit</td></tr><tr><td>provided</td><td>√</td><td>√</td><td>-</td><td>servlet-api</td></tr><tr><td>runtime</td><td>-</td><td>√</td><td>√</td><td>JDBC-driver</td></tr><tr><td>system</td><td>√</td><td>√</td><td>-</td><td>非 Maven 仓库的本地依赖</td></tr></tbody></table><h2 id="依赖范围对传递依赖的影响" tabindex="-1">依赖范围对传递依赖的影响 <a class="header-anchor" href="#依赖范围对传递依赖的影响" aria-label="Permalink to &quot;依赖范围对传递依赖的影响&quot;">​</a></h2><p>项目 A 依赖于项目 B，B 又依赖于项目 C，此时我们可以将 A 对于 B 的依赖称之为第一直接依赖，B 对于 C 的依赖称之为第二直接依赖。</p><p>B 是 A 的直接依赖，C 是 A 的间接依赖，根据 Maven 的依赖传递机制，间接依赖 C 会以传递性依赖的形式引入到 A 中，但这种引入并不是无条件的，它会受到依赖范围的影响。</p><p>传递性依赖的依赖范围受第一直接依赖和第二直接依赖的范围影响，如下表所示。</p><table tabindex="0"><thead><tr><th></th><th>compile</th><th>test</th><th>provided</th><th>runtime</th></tr></thead><tbody><tr><td>compile</td><td>compile</td><td>-</td><td>-</td><td>runtime</td></tr><tr><td>test</td><td>test</td><td>-</td><td>-</td><td>test</td></tr><tr><td>provided</td><td>provided</td><td>-</td><td>provided</td><td>provided</td></tr><tr><td>runtime</td><td>runtime</td><td>-</td><td>-</td><td>runtime</td></tr></tbody></table><p>注：上表中，左边第一列表示第一直接依赖的依赖范围，上边第一行表示第二直接依赖的依赖范围。交叉部分的单元格的取值为传递性依赖的依赖范围，若交叉单元格取值为“-”，则表示该传递性依赖不能被传递。</p><p>通过上表，可以总结出以下规律：</p><ul><li>当第二直接依赖的范围是 compile 时，传递性依赖的范围与第一直接依赖的范围一致；</li><li>当第二直接依赖的范围是 test 时，传递性依赖不会被传递；</li><li>当第二直接依赖的范围是 provided 时，只传递第一直接依赖的范围也为 provided 的依赖，且传递性依赖的范围也为 provided；</li><li>当第二直接依赖的范围是 runtime 时，传递性依赖的范围与第一直接依赖的范围一致，但 compile 例外，此时传递性依赖的范围为 runtime。</li></ul><h2 id="依赖调节" tabindex="-1">依赖调节 <a class="header-anchor" href="#依赖调节" aria-label="Permalink to &quot;依赖调节&quot;">​</a></h2><p>Maven 的依赖传递机制可以简化依赖的声明，用户只需要关心项目的直接依赖，而不必关心这些直接依赖会引入哪些间接依赖。但当一个间接依赖存在多条引入路径时，为了避免出现依赖重复的问题，Maven 通过依赖调节来确定间接依赖的引入路径。</p><p>依赖调节遵循以下两条原则：</p><ol><li>引入路径短者优先</li><li>先声明者优先</li></ol><p>以上两条原则，优先使用第一条原则解决，第一条原则无法解决，再使用第二条原则解决。</p><h3 id="引入路径短者优先" tabindex="-1">引入路径短者优先 <a class="header-anchor" href="#引入路径短者优先" aria-label="Permalink to &quot;引入路径短者优先&quot;">​</a></h3><p>引入路径短者优先，顾名思义，当一个间接依赖存在多条引入路径时，引入路径短的会被解析使用。</p><p>例如，A 存在这样的依赖关系： A-&gt;B-&gt;C-&gt;D(1.0) A-&gt;X-&gt;D(2.0)</p><p>D 是 A 的间接依赖，但两条引入路径上有两个不同的版本，很显然不能同时引入，否则造成重复依赖的问题。根据 Maven 依赖调节的第一个原则：引入路径短者优先，D（1.0）的路径长度为 3，D（2.0）的路径长度为 2，因此间接依赖 D（2.0）将从 A-&gt;X-&gt;D(2.0) 路径引入到 A 中。</p><h3 id="先声明者优先" tabindex="-1">先声明者优先 <a class="header-anchor" href="#先声明者优先" aria-label="Permalink to &quot;先声明者优先&quot;">​</a></h3><p>先声明者优先，顾名思义，在引入路径长度相同的前提下，POM 文件中依赖声明的顺序决定了间接依赖会不会被解析使用，顺序靠前的优先使用。</p><p>例如，A 存在以下依赖关系： A-&gt;B-&gt;D(1.0) A-&gt;X-&gt;D(2.0)</p><p>D 是 A 的间接依赖，其两条引入路径的长度都是 2，此时 Maven 依赖调节的第一原则已经无法解决，需要使用第二原则：先声明者优先。</p><p>A 的 POM 文件中配置如下。</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;B&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;       </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;X&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>有以上配置可以看出，由于 B 的依赖声明比 X 靠前，所以间接依赖 D（1.0）将从 A-&gt;B-&gt;D(1.0) 路径引入到 A 中。</p><p>我们知道 Maven 依赖具有传递性，例如 A 依赖于 B，B 依赖于 C，在不考虑依赖范围等因素的情况下，Maven 会根据依赖传递机制，将间接依赖 C 引入到 A 中。但如果 A 出于某种原因，希望将间接依赖 C 排除，那该怎么办呢？Maven 为用户提供了两种解决方式：排除依赖（Dependency Exclusions）和可选依赖（Optional Dependencies）。</p><h2 id="排除依赖" tabindex="-1">排除依赖 <a class="header-anchor" href="#排除依赖" aria-label="Permalink to &quot;排除依赖&quot;">​</a></h2><p>假设存在这样的依赖关系，A 依赖于 B，B 依赖于 X，B 又依赖于 Y。B 实现了两个特性，其中一个特性依赖于 X，另一个特性依赖于 Y，且两个特性是互斥的关系，用户无法同时使用两个特性，所以 A 需要排除 X，此时就可以在 A 中将间接依赖 X 排除。</p><p>排除依赖是通过在 A 中使用 exclusions 元素实现的，该元素下可以包含若干个 exclusion 子元素，用于排除若干个间接依赖，示例代码如下。</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">project</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:xsi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         xsi:schemaLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">modelVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;4.0.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">modelVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.biancheng.www&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;A&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1.0-SNAPSHOT&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.biancheng.www&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;B&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1.0-SNAPSHOT&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exclusions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                &lt;!-- 设置排除 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                &lt;!-- 排除依赖必须基于直接依赖中的间接依赖设置为可以依赖为 false --&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                &lt;!-- 设置当前依赖中是否使用间接依赖 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exclusion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    &lt;!--设置具体排除--&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.biancheng.www&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;X&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exclusion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exclusions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>关于 exclusions 元素及排除依赖说明如下：</p><ul><li>排除依赖是控制当前项目是否使用其直接依赖传递下来的接间依赖；</li><li>exclusions 元素下可以包含若干个 exclusion 子元素，用于排除若干个间接依赖；</li><li>exclusion 元素用来设置具体排除的间接依赖，该元素包含两个子元素：groupId 和 artifactId，用来确定需要排除的间接依赖的坐标信息；</li><li>exclusion 元素中只需要设置 groupId 和 artifactId 就可以确定需要排除的依赖，无需指定版本 version。</li></ul><h2 id="可选依赖" tabindex="-1">可选依赖 <a class="header-anchor" href="#可选依赖" aria-label="Permalink to &quot;可选依赖&quot;">​</a></h2><p>与上文的应用场景相同，也是 A 希望排除间接依赖 X，我们还可以在 B 中将 X 设置为可选依赖。</p><h3 id="设置可选依赖" tabindex="-1">设置可选依赖 <a class="header-anchor" href="#设置可选依赖" aria-label="Permalink to &quot;设置可选依赖&quot;">​</a></h3><p>在 B 的 POM 关于 X 的依赖声明中使用 optional 元素，将其设置成可选依赖，示例配置如下。</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">project</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         xmlns:xsi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         xsi:schemaLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">modelVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;4.0.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">modelVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.biancheng.www&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;B&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">packaging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;jar&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">packaging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1.0-SNAPSHOT&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.biancheng.www&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;X&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1.0-SNAPSHOT&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            &lt;!--设置可选依赖  --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;true&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>关于 optional 元素及可选依赖说明如下：</p><ul><li>可选依赖用来控制当前依赖是否向下传递成为间接依赖；</li><li>optional 默认值为 false，表示可以向下传递称为间接依赖；</li><li>若 optional 元素取值为 true，则表示当前依赖不能向下传递成为间接依赖。</li></ul><h2 id="排除依赖-vs-可选依赖" tabindex="-1">排除依赖 VS 可选依赖 <a class="header-anchor" href="#排除依赖-vs-可选依赖" aria-label="Permalink to &quot;排除依赖 VS 可选依赖&quot;">​</a></h2><p>排除依赖和可选依赖都能在项目中将间接依赖排除在外，但两者实现机制却完全不一样。</p><ul><li>排除依赖是控制当前项目是否使用其直接依赖传递下来的接间依赖；</li><li>可选依赖是控制当前项目的依赖是否向下传递；</li><li>可选依赖的优先级高于排除依赖；</li><li>若对于同一个间接依赖同时使用排除依赖和可选依赖进行设置，那么可选依赖的取值必须为 false，否则排除依赖无法生效。</li></ul><p><img src="`+p+'" alt=""></p>',58)]))}const o=i(h,[["render",e]]);export{y as __pageData,o as default};
